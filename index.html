<!DOCTYPE html>
<html>
  <head>
    <title>経路表示</title>
    <meta charset="UTF-8" />
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAmCK1JvfSc3JMgPFyr6FXu3Dx__OyLTwY&libraries=places"></script>
    <script>
      function initMap() {
        const url = new URL(window.location.href);
        const origin = url.searchParams.get("origin");  // 緯度,経度
        const destination = url.searchParams.get("destination");

        if (!origin || !destination) {
          alert("パラメータが不足しています");
          return;
        }

        const [olat, olng] = origin.split(",");
        const [dlat, dlng] = destination.split(",");

        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 13,
          center: { lat: parseFloat(olat), lng: parseFloat(olng) },
        });

        const directionsService = new google.maps.DirectionsService();
        const directionsRenderer = new google.maps.DirectionsRenderer();
        directionsRenderer.setMap(map);

        directionsService.route(
          {
            origin: { lat: parseFloat(olat), lng: parseFloat(olng) },
            destination: { lat: parseFloat(dlat), lng: parseFloat(dlng) },
            travelMode: google.maps.TravelMode.DRIVING,
          },
          (result, status) => {
            if (status === "OK") {
              directionsRenderer.setDirections(result);
            } else {
              alert("経路を取得できません: " + status);
            }
          }
        );
      }
    </script>
  </head>
  <body onload="initMap()">
    <h2>ルートマップ</h2>
    <div id="map" style="width: 100%; height: 500px;"></div>
  </body>
</html>
